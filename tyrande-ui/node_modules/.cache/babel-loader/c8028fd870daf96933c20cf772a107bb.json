{"remainingRequest":"D:\\other4\\Tyrande\\tyrande-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\other4\\Tyrande\\tyrande-ui\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\other4\\Tyrande\\tyrande-ui\\src\\store\\modules\\user.js","dependencies":[{"path":"D:\\other4\\Tyrande\\tyrande-ui\\src\\store\\modules\\user.js","mtime":1597643615000},{"path":"D:\\other4\\Tyrande\\tyrande-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\other4\\Tyrande\\tyrande-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\other4\\Tyrande\\tyrande-ui\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbSI7CmltcG9ydCB7IGdldEluZm8gYXMgX2dldEluZm8sIGxvZ2luIGFzIF9sb2dpbiwgbG9nb3V0IGFzIF9sb2dvdXQgfSBmcm9tICdAL2FwaS91c2VyJzsKaW1wb3J0IHsgZ2V0VG9rZW4sIHJlbW92ZVRva2VuLCBzZXRUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7CmltcG9ydCB7IHJlc2V0Um91dGVyIH0gZnJvbSAnQC9yb3V0ZXInOwoKdmFyIGdldERlZmF1bHRTdGF0ZSA9IGZ1bmN0aW9uIGdldERlZmF1bHRTdGF0ZSgpIHsKICByZXR1cm4gewogICAgdG9rZW46IGdldFRva2VuKCksCiAgICBuYW1lOiAnJywKICAgIGF2YXRhcjogJycsCiAgICByb2xlczogW10KICB9Owp9OwoKdmFyIHN0YXRlID0gZ2V0RGVmYXVsdFN0YXRlKCk7CnZhciBtdXRhdGlvbnMgPSB7CiAgUkVTRVRfU1RBVEU6IGZ1bmN0aW9uIFJFU0VUX1NUQVRFKHN0YXRlKSB7CiAgICBPYmplY3QuYXNzaWduKHN0YXRlLCBnZXREZWZhdWx0U3RhdGUoKSk7CiAgfSwKICBTRVRfVE9LRU46IGZ1bmN0aW9uIFNFVF9UT0tFTihzdGF0ZSwgdG9rZW4pIHsKICAgIHN0YXRlLnRva2VuID0gdG9rZW47CiAgfSwKICBTRVRfTkFNRTogZnVuY3Rpb24gU0VUX05BTUUoc3RhdGUsIG5hbWUpIHsKICAgIHN0YXRlLm5hbWUgPSBuYW1lOwogIH0sCiAgU0VUX0FWQVRBUjogZnVuY3Rpb24gU0VUX0FWQVRBUihzdGF0ZSwgYXZhdGFyKSB7CiAgICBzdGF0ZS5hdmF0YXIgPSBhdmF0YXI7CiAgfSwKICBTRVRfUk9MRVM6IGZ1bmN0aW9uIFNFVF9ST0xFUyhzdGF0ZSwgcm9sZXMpIHsKICAgIHN0YXRlLnJvbGVzID0gcm9sZXM7CiAgfSwKICBTRVRfTUVOVVM6IGZ1bmN0aW9uIFNFVF9NRU5VUyhzdGF0ZSwgbWVudXMpIHsKICAgIHN0YXRlLm1lbnVzID0gbWVudXM7CiAgfQp9Owp2YXIgYWN0aW9ucyA9IHsKICAvKioKICAgKiDnlKjmiLfnmbvlvZUKICAgKi8KICBsb2dpbjogZnVuY3Rpb24gbG9naW4oX3JlZiwgdXNlckluZm8pIHsKICAgIHZhciBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgIHZhciB1c2VybmFtZSA9IHVzZXJJbmZvLnVzZXJuYW1lLAogICAgICAgIHBhc3N3b3JkID0gdXNlckluZm8ucGFzc3dvcmQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBfbG9naW4oewogICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZS50cmltKCksCiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgIGNvbW1pdCgnU0VUX1RPS0VOJywgZGF0YSk7CiAgICAgICAgc2V0VG9rZW4oZGF0YSk7CiAgICAgICAgcmVzb2x2ZSgpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0sCgogIC8qKgogICAqIOafpeivoueUqOaIt+S/oeaBrwogICAqLwogIGdldEluZm86IGZ1bmN0aW9uIGdldEluZm8oX3JlZjIpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMi5jb21taXQsCiAgICAgICAgc3RhdGUgPSBfcmVmMi5zdGF0ZTsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIF9nZXRJbmZvKHN0YXRlLnRva2VuKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgaWYgKCFkYXRhKSB7CiAgICAgICAgICByZWplY3QoJ+mqjOivgeWksei0pe+8jOivt+mHjeaWsOeZu+W9lScpOwogICAgICAgIH0KCiAgICAgICAgdmFyIHJvbGVzID0gZGF0YS5yb2xlcywKICAgICAgICAgICAgbmFtZSA9IGRhdGEubmFtZSwKICAgICAgICAgICAgYXZhdGFyID0gZGF0YS5hdmF0YXIsCiAgICAgICAgICAgIG1lbnVzID0gZGF0YS5tZW51czsKCiAgICAgICAgaWYgKCFyb2xlcyB8fCByb2xlcy5sZW5ndGggPD0gMCkgewogICAgICAgICAgcmVqZWN0KCfnlKjmiLflv4Xpobvmi6XmnInop5LoibIhJyk7CiAgICAgICAgfQoKICAgICAgICBjb21taXQoJ1NFVF9ST0xFUycsIHJvbGVzKTsKICAgICAgICBjb21taXQoJ1NFVF9OQU1FJywgbmFtZSk7CiAgICAgICAgY29tbWl0KCdTRVRfQVZBVEFSJywgYXZhdGFyKTsKICAgICAgICBjb21taXQoJ1NFVF9NRU5VUycsIG1lbnVzKTsKICAgICAgICByZXNvbHZlKGRhdGEpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0sCgogIC8qKgogICAqIOeUqOaIt+eZu+WHugogICAqLwogIGxvZ291dDogZnVuY3Rpb24gbG9nb3V0KF9yZWYzKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjMuY29tbWl0LAogICAgICAgIHN0YXRlID0gX3JlZjMuc3RhdGU7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBfbG9nb3V0KHN0YXRlLnRva2VuKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZW1vdmVUb2tlbigpOwogICAgICAgIHJlc2V0Um91dGVyKCk7CiAgICAgICAgY29tbWl0KCdSRVNFVF9TVEFURScpOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9KTsKICB9LAoKICAvKioKICAgKiDnp7vpmaQgdG9rZW4KICAgKi8KICByZXNldFRva2VuOiBmdW5jdGlvbiByZXNldFRva2VuKF9yZWY0KSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjQuY29tbWl0OwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIHJlbW92ZVRva2VuKCk7CiAgICAgIGNvbW1pdCgnUkVTRVRfU1RBVEUnKTsKICAgICAgcmVzb2x2ZSgpOwogICAgfSk7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZXNwYWNlZDogdHJ1ZSwKICBzdGF0ZTogc3RhdGUsCiAgbXV0YXRpb25zOiBtdXRhdGlvbnMsCiAgYWN0aW9uczogYWN0aW9ucwp9Ow=="},{"version":3,"sources":["D:/other4/Tyrande/tyrande-ui/src/store/modules/user.js"],"names":["getInfo","login","logout","getToken","removeToken","setToken","resetRouter","getDefaultState","token","name","avatar","roles","state","mutations","RESET_STATE","Object","assign","SET_TOKEN","SET_NAME","SET_AVATAR","SET_ROLES","SET_MENUS","menus","actions","userInfo","commit","username","password","Promise","resolve","reject","trim","then","response","data","catch","error","length","resetToken","namespaced"],"mappings":"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","sourcesContent":["import { getInfo, login, logout } from '@/api/user'\nimport { getToken, removeToken, setToken } from '@/utils/auth'\nimport { resetRouter } from '@/router'\n\nconst getDefaultState = () => {\n  return {\n    token: getToken(),\n    name: '',\n    avatar: '',\n    roles: []\n  }\n}\n\nconst state = getDefaultState()\n\nconst mutations = {\n  RESET_STATE: (state) => {\n    Object.assign(state, getDefaultState())\n  },\n  SET_TOKEN: (state, token) => {\n    state.token = token\n  },\n  SET_NAME: (state, name) => {\n    state.name = name\n  },\n  SET_AVATAR: (state, avatar) => {\n    state.avatar = avatar\n  },\n  SET_ROLES: (state, roles) => {\n    state.roles = roles\n  },\n  SET_MENUS: (state, menus) => {\n    state.menus = menus\n  }\n}\n\nconst actions = {\n\n  /**\n   * 用户登录\n   */\n  login({ commit }, userInfo) {\n    const { username, password } = userInfo\n    return new Promise((resolve, reject) => {\n      login({ username: username.trim(), password: password }).then(response => {\n        const { data } = response\n        commit('SET_TOKEN', data)\n        setToken(data)\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  /**\n   * 查询用户信息\n   */\n  getInfo({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      getInfo(state.token).then(response => {\n        const { data } = response\n\n        if (!data) {\n          reject('验证失败，请重新登录')\n        }\n\n        const { roles, name, avatar, menus } = data\n\n        if (!roles || roles.length <= 0) {\n          reject('用户必须拥有角色!')\n        }\n\n        commit('SET_ROLES', roles)\n        commit('SET_NAME', name)\n        commit('SET_AVATAR', avatar)\n        commit('SET_MENUS', menus)\n        resolve(data)\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  /**\n   * 用户登出\n   */\n  logout({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      logout(state.token).then(() => {\n        removeToken()\n        resetRouter()\n        commit('RESET_STATE')\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  /**\n   * 移除 token\n   */\n  resetToken({ commit }) {\n    return new Promise(resolve => {\n      removeToken()\n      commit('RESET_STATE')\n      resolve()\n    })\n  }\n}\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions\n}\n\n"]}]}